<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mijnenveger</title>
    <style>
    :root{--x:16;--y:16;--b:10;}
    #speelveld{border:2px solid red;position:relative;background-color: lightgrey;}
    .blokje{width:20px;height:26px;background-color:beige;border:1px solid green;box-shadow:black 2px 2px 1px 1px; 
    position:absolute;margin:1px;font-size:24px;font-weight: 900;padding-left:6px;}
    .blokje:hover{background-color: khaki;box-shadow:black 1px 1px 0px 1px;}
    .leeg{width:22px;height:30px;background-color:lightgrey;border:1px solid grey;box-shadow: none;
    position:absolute;margin:0;font-size:24px;font-weight: 900;padding-left:8px;}
    .r0{color:lightgrey;}
    .r1{color:green;}
    .r2{color:red;}
    </style>
    <script src="http://code.jquery.com/jquery-3.2.1.min.js"></script>
    <script>

        
        var x=16;//aantal kolommen
        var y=10;//aantal rijen
        var b=10;//aantal bommen
        var bom=new Array(0);//plaats van bom
        var p=new Array(x*y);//array posities
        var gb=new Array(0);//plaats gecheckt zonder bom
        for(var i=0;i<p.length;i++){p[i]=0;};

        function frame(x,y,b){
            field.innerHTML="<div id='speelveld' style='width:"+(x*32)+"px;height:"+(y*32)+"px;'></div>";
            var html="";
            for(var j=0;j<y;j++){
                for(var i=0;i<x;i++){
                    html+="<div class='blokje' id='"+((j==0?0:j*x)+i)+"' onclick='klikLinks(event,"+((j==0?0:j*x)+i)+")' "+
                        "oncontextmenu='klikRechts(event,"+((j==0?0:j*x)+i)+")' style='left:"+(i*32)+"px;top:"+(j*32)+"px;'></div>"
                }
            }
            speelveld.innerHTML=html;
        }

        function klikLinks(event,xy){
            $('#'+xy).removeClass().addClass('leeg');
            if($.inArray(xy, bom) !== -1){$('#'+xy).text("x");}
            else{geenBom(xy)}
        }

        function geenBom(xy){
            $('#'+xy).addClass("leeg o");
            var a=0;var aa=0;
            for(var j=-1*x;j<2*x;j+=x){
                for(var i=xy%x==0?0:-1;i<((xy+1)%x==0?1:2);i++){var z=(xy+j)+i;
                    if(z>=0 && z<x*y){
                        if($.inArray(z, bom) !== -1){a++}
                        else if(!$('#'+z).hasClass('o') && $.inArray(z, gb) == -1){gb.push(z);aa++}
                    }
                } 
            }
            $('#'+xy).text(""+a==0?"":a).css("color", "rgb("+(0+(60*(a==0?1:a>4?4.2:a)))+","+(255-(60*(a==0?1:a>4?4.2:a)))+",0)");
            if(a>0){for(var i=0;i<aa;i++){gb.pop();}};
            if(gb.length>0){let next=gb[0];gb.splice(0,1);geenBom(next);}
        }

        function klikRechts(event,xy){
            event.preventDefault();
            if($('#'+xy).hasClass('blokje')){
            $('#'+xy).removeClass('r'+p[xy]).addClass('r'+(p[xy]>2?p[xy]=0:p[xy]+=1)).text(p[xy]==1?"v":p[xy]==2?"?":"");
            }
        }

        function bommen(b){
            while(bom.length<b){
                var x=Math.floor(Math.random()*p.length);
                if($.inArray(x, bom) == -1){bom.push(x)};
            };alert(bom);
        }

                

    $(function(){
        frame(x,y,b);
        bommen(b);

    });

    </script>
</head>
<body>
    <div id="field"></div>
    
</body>
</html>